# ========================================
# User Service Configuration
# Spring Boot 2.7.18 (Java 8 Compatible)
# ========================================

# Server Configuration
server.port=8080
server.servlet.context-path=/

# Application Name
spring.application.name=user-service

# ========================================
# Database Configuration
# ========================================
spring.datasource.url=jdbc:mysql://localhost:3306/student_analytics?createDatabaseIfNotExist=true&useSSL=false&allowPublicKeyRetrieval=true&serverTimezone=UTC
spring.datasource.username=root
spring.datasource.password=
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# Connection Pool Settings
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.connection-timeout=30000

# ========================================
# JPA / Hibernate Configuration
# ========================================
# Don't let Hibernate create tables (we use schema.sql)
spring.jpa.hibernate.ddl-auto=none

# Show SQL queries in console (useful for debugging)
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true

# MySQL Dialect
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQL8Dialect

# Naming strategy (match database column names exactly)
spring.jpa.hibernate.naming.physical-strategy=org.hibernate.boot.model.naming.PhysicalNamingStrategyStandardImpl
spring.jpa.hibernate.naming.implicit-strategy=org.hibernate.boot.model.naming.ImplicitNamingStrategyLegacyJpaImpl

# ========================================
# SQL Initialization (schema.sql and data.sql)
# ========================================
# Run schema.sql and data.sql on startup
spring.datasource.initialization-mode=always

# Don't defer initialization (run immediately)
spring.jpa.defer-datasource-initialization=false

# Continue on SQL errors (useful during development)
spring.datasource.continue-on-error=false

# SQL script encoding
spring.datasource.sql-script-encoding=UTF-8

# ========================================
# JWT Configuration
# ========================================
# Secret key for JWT signing (CHANGE THIS IN PRODUCTION!)
jwt.secret=StudentAnalyticsPlatformSecretKey2025ThisIsAVeryLongSecretKeyForHS256Algorithm

# JWT token expiration (24 hours in milliseconds)
jwt.expiration=86400000

# JWT token prefix
jwt.token.prefix=Bearer 

# JWT header name
jwt.header=Authorization

# ========================================
# Security Configuration
# ========================================
# Allow H2 console (if using H2 for testing)
spring.h2.console.enabled=false

# ========================================
# Logging Configuration
# ========================================
# Application logging level
logging.level.com.studentanalytics=DEBUG

# Spring Security logging
logging.level.org.springframework.security=DEBUG

# Hibernate SQL logging
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE

# General Spring logging
logging.level.org.springframework.web=INFO

# Log file configuration
logging.file.name=logs/user-service.log
logging.file.max-size=10MB
logging.file.max-history=30

# Log pattern
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} - %msg%n
logging.pattern.file=%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n

# ========================================
# Jackson Configuration (JSON)
# ========================================
spring.jackson.serialization.write-dates-as-timestamps=false
spring.jackson.time-zone=UTC
spring.jackson.default-property-inclusion=non_null

# ========================================
# Error Handling
# ========================================
server.error.include-message=always
server.error.include-binding-errors=always
server.error.include-stacktrace=on_param
server.error.include-exception=false

# ========================================
# CORS Configuration (if needed for frontend)
# ========================================
# Allow all origins (change in production!)
cors.allowed-origins=http://localhost:3000,http://localhost:8081,http://localhost:8082,http://localhost:8083,http://localhost:8084,http://localhost:8085

# ========================================
# Actuator (Health Check) - Optional
# ========================================
management.endpoints.web.exposure.include=health,info
management.endpoint.health.show-details=when-authorized

# ========================================
# Development Settings
# ========================================
# Disable template caching for development
spring.thymeleaf.cache=false

# DevTools
spring.devtools.restart.enabled=true
spring.devtools.livereload.enabled=true